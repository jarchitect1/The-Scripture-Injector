/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var I=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var z=Object.prototype.hasOwnProperty;var D=(o,r)=>{for(var e in r)I(o,e,{get:r[e],enumerable:!0})},J=(o,r,e,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of M(r))!z.call(o,t)&&t!==e&&I(o,t,{get:()=>r[t],enumerable:!(s=C(r,t))||s.enumerable});return o};var L=o=>J(I({},"__esModule",{value:!0}),o);var K={};D(K,{default:()=>V});module.exports=L(K);var l=require("obsidian");var b=class{handleError(r,e){let s={message:`Failed to fetch verse from ${e}: ${r.message}`};throw r.status&&(s.status=r.status),r.code&&(s.code=r.code),s}};var x=require("obsidian"),f=class extends b{constructor(e){super();this.baseUrl="https://api.esv.org/v3/passage/text/";if(!e)throw new Error("ESV API key is required");this.apiKey=e}async fetchVerse(e){try{let s=`${this.baseUrl}?q=${encodeURIComponent(e)}`,t=await(0,x.requestUrl)({url:s,method:"GET",headers:{Authorization:`Token ${this.apiKey}`}});if(t.status!==200)throw new Error(`ESV API error: ${t.status}`);try{let n=JSON.parse(t.text);if(!n.passages||!Array.isArray(n.passages)||n.passages.length===0)throw new Error("No passages found in ESV API response");let a=n.passages[0].trim(),c=n.canonical||e,i=a.split(`
`);return i.length>1&&i.shift(),a=i.join(`
`).trim(),a=a.replace(/\(ESV\)\s*$/,""),a=a.replace(/\[/g,"<sup>").replace(/\]/g,"</sup>"),{reference:c,text:a,translation:"ESV"}}catch(n){throw new Error("Failed to parse ESV API response")}}catch(s){this.handleError(s,"ESV API")}}async testConnection(){try{let e=await(0,x.requestUrl)({url:`${this.baseUrl}?q=John+3:16`,method:"GET",headers:{Authorization:`Token ${this.apiKey}`}});if(e.status!==200)return!1;try{let s=JSON.parse(e.text);return s.passages&&Array.isArray(s.passages)&&s.passages.length>0}catch(s){return!1}}catch(e){return!1}}};var N=class extends b{constructor(){super(...arguments);this.baseUrl="https://labs.bible.org/api/?"}async fetchVerse(e){try{let s=`${this.baseUrl}passage=${encodeURIComponent(e)}&formatting=para`,t=await fetch(s);if(!t.ok)throw new Error(`NET Bible API error: ${t.statusText}`);let n=await t.text();if(!n||n.trim().length===0)throw new Error("No passage found for the given reference");let a=e.match(/^(\d?\s?\w+)\s+(\d+):/);if(!a){let u=e.match(/^(\d?\s?\w+)\s+(\d+)$/);if(!u)throw new Error("Invalid reference format");let B=u[1].trim(),P=u[2],j=/<b>(\d+(?::\d+)?|\d+)<\/b>/g,p=[],v;for(;(v=j.exec(n))!==null;){let A=v[1].includes(":")?parseInt(v[1].split(":")[1]):parseInt(v[1]);isNaN(A)||p.push(A)}let k=`${B} ${P}`;p.length>1?k+=`:${p[0]}-${p[p.length-1]}`:p.length===1&&(k+=`:${p[0]}`);let R=n.replace(/<b>/g,"<sup>").replace(/<\/b>/g,"</sup>").replace(/<p[^>]*>/g,"").replace(/<\/p>/g,`

`);return{reference:k,text:R,translation:"NET"}}let c=a[1].trim(),i=a[2],m=/<b>(\d+(?::\d+)?|\d+)<\/b>/g,h=[],g;for(;(g=m.exec(n))!==null;){let u=g[1].includes(":")?parseInt(g[1].split(":")[1]):parseInt(g[1]);isNaN(u)||h.push(u)}let $=`${c} ${i}`;h.length===1?$+=`:${h[0]}`:h.length>1&&($+=`:${h[0]}-${h[h.length-1]}`);let T=n.replace(/<b>/g,"<sup>").replace(/<\/b>/g,"</sup>").replace(/<p[^>]*>/g,"").replace(/<\/p>/g,`

`).trim();return{reference:$,text:T,translation:"NET"}}catch(s){this.handleError(s,"NET Bible API")}}async testConnection(){try{return(await fetch(`${this.baseUrl}passage=John%203:16`)).ok}catch(e){return!1}}validateReference(e){return/^[1-3]?\s?\w+\s+\d+:\d+(?:-\d+)?$/.test(e.trim())}};var w=class{constructor(){this.bookNames=new Map;this.bookAbbreviations=new Map;this.bookData=new Map;this.initializeBookMappings()}parse(r){let e=r.trim(),s=/^(\d?\s?\w+)\s+(\d+)(?::(\d+)(?:-(\d+))?)?(?:-(\d+):(\d+))?$/i,t=e.match(s);if(!t){let c=/^(\d?\s?\w+)\s+(\d+)$/i,i=e.match(c);if(i){let m=this.normalizeBookName(i[1]),h=parseInt(i[2]);return{book:m,chapter:h,verses:[],translation:""}}throw new Error(`Invalid Bible reference format: "${r}"`)}let n=this.normalizeBookName(t[1]),a=parseInt(t[2]);if(t[5]&&t[6]){let c=parseInt(t[5]),i=parseInt(t[6]),m=parseInt(t[3]||"1");return{book:n,chapter:a,verses:[{start:m,end:i}],translation:""}}if(t[3]){let c=parseInt(t[3]),i=t[4]?parseInt(t[4]):c;return{book:n,chapter:a,verses:[{start:c,end:i}],translation:""}}return{book:n,chapter:a,verses:[],translation:""}}normalizeBookName(r){let e=r.trim().toLowerCase().replace(/\s+/g,"");if(this.bookNames.has(e))return this.bookNames.get(e);if(this.bookAbbreviations.has(e))return this.bookAbbreviations.get(e);for(let[s,t]of this.bookAbbreviations)if(e.startsWith(s)||s.startsWith(e))return t;return r.trim()}getBookInfo(r){let e=this.normalizeBookName(r);return this.bookData.get(e)||null}validateReference(r){let e=[],s=this.getBookInfo(r.book);if(!s)return e.push(`Unknown book: "${r.book}"`),{valid:!1,errors:e};(r.chapter<1||r.chapter>s.chapters)&&e.push(`Invalid chapter ${r.chapter} for ${r.book}. Book has ${s.chapters} chapters.`);for(let t of r.verses)typeof t=="object"&&(t.start<1||t.end<t.start)&&e.push(`Invalid verse range: ${t.start}-${t.end}`);return{valid:e.length===0,errors:e}}initializeBookMappings(){let r=[{fullName:"Genesis",abbreviations:["gen","ge","gn"],chapters:50},{fullName:"Exodus",abbreviations:["exod","ex","exo"],chapters:40},{fullName:"Leviticus",abbreviations:["lev","le","lv"],chapters:27},{fullName:"Numbers",abbreviations:["num","nu","nm"],chapters:36},{fullName:"Deuteronomy",abbreviations:["deut","de","dt"],chapters:34},{fullName:"Joshua",abbreviations:["josh","jos","jsh"],chapters:24},{fullName:"Judges",abbreviations:["judg","jdg","jdgs"],chapters:21},{fullName:"Ruth",abbreviations:["ruth","ru","rt"],chapters:4},{fullName:"1 Samuel",abbreviations:["1sam","1sa","1sm"],chapters:31},{fullName:"2 Samuel",abbreviations:["2sam","2sa","2sm"],chapters:24},{fullName:"1 Kings",abbreviations:["1kgs","1ki","1k"],chapters:22},{fullName:"2 Kings",abbreviations:["2kgs","2ki","2k"],chapters:25},{fullName:"1 Chronicles",abbreviations:["1chr","1ch","1cr"],chapters:29},{fullName:"2 Chronicles",abbreviations:["2chr","2ch","2cr"],chapters:36},{fullName:"Ezra",abbreviations:["ezra","ezr"],chapters:10},{fullName:"Nehemiah",abbreviations:["neh","ne","nh"],chapters:13},{fullName:"Esther",abbreviations:["esth","est","es"],chapters:10},{fullName:"Job",abbreviations:["job"],chapters:42},{fullName:"Psalm",abbreviations:["ps","psalm"],chapters:150},{fullName:"Proverbs",abbreviations:["prov","pr","prv"],chapters:31},{fullName:"Ecclesiastes",abbreviations:["eccl","ecc","ec"],chapters:12},{fullName:"Song of Solomon",abbreviations:["song","ss","canticles"],chapters:8},{fullName:"Isaiah",abbreviations:["isa","is"],chapters:66},{fullName:"Jeremiah",abbreviations:["jer","je","jr"],chapters:52},{fullName:"Lamentations",abbreviations:["lam","la"],chapters:5},{fullName:"Ezekiel",abbreviations:["ezek","eze","ez"],chapters:48},{fullName:"Daniel",abbreviations:["dan","da","dn"],chapters:12},{fullName:"Hosea",abbreviations:["hos","ho"],chapters:14},{fullName:"Joel",abbreviations:["joel","jl"],chapters:3},{fullName:"Amos",abbreviations:["amos","am"],chapters:9},{fullName:"Obadiah",abbreviations:["obad","ob"],chapters:1},{fullName:"Jonah",abbreviations:["jonah","jon","jnh"],chapters:4},{fullName:"Micah",abbreviations:["mic","mi"],chapters:7},{fullName:"Nahum",abbreviations:["nah","na"],chapters:3},{fullName:"Habakkuk",abbreviations:["hab","ha"],chapters:3},{fullName:"Zephaniah",abbreviations:["zeph","zep"],chapters:3},{fullName:"Haggai",abbreviations:["hag","hg"],chapters:2},{fullName:"Zechariah",abbreviations:["zech","zec"],chapters:14},{fullName:"Malachi",abbreviations:["mal","ml"],chapters:4},{fullName:"Matthew",abbreviations:["matt","mt"],chapters:28},{fullName:"Mark",abbreviations:["mark","mk","mr"],chapters:16},{fullName:"Luke",abbreviations:["luke","lk"],chapters:24},{fullName:"John",abbreviations:["john","jn"],chapters:21},{fullName:"Acts",abbreviations:["acts","ac"],chapters:28},{fullName:"Romans",abbreviations:["rom","ro","rm"],chapters:16},{fullName:"1 Corinthians",abbreviations:["1cor","1co","1cr"],chapters:16},{fullName:"2 Corinthians",abbreviations:["2cor","2co","2cr"],chapters:13},{fullName:"Galatians",abbreviations:["gal","ga"],chapters:6},{fullName:"Ephesians",abbreviations:["eph","ep"],chapters:6},{fullName:"Philippians",abbreviations:["phil","php","pp"],chapters:4},{fullName:"Colossians",abbreviations:["col","co"],chapters:4},{fullName:"1 Thessalonians",abbreviations:["1thess","1th","1thes"],chapters:5},{fullName:"2 Thessalonians",abbreviations:["2thess","2th","2thes"],chapters:3},{fullName:"1 Timothy",abbreviations:["1tim","1ti","1tm"],chapters:6},{fullName:"2 Timothy",abbreviations:["2tim","2ti","2tm"],chapters:4},{fullName:"Titus",abbreviations:["titus","tit","ti"],chapters:3},{fullName:"Philemon",abbreviations:["philem","phm","pm"],chapters:1},{fullName:"Hebrews",abbreviations:["heb","he"],chapters:13},{fullName:"James",abbreviations:["jas","jam","jm"],chapters:5},{fullName:"1 Peter",abbreviations:["1pet","1pe","1pt"],chapters:5},{fullName:"2 Peter",abbreviations:["2pet","2pe","2pt"],chapters:3},{fullName:"1 John",abbreviations:["1john","1jn","1j"],chapters:5},{fullName:"2 John",abbreviations:["2john","2jn","2j"],chapters:1},{fullName:"3 John",abbreviations:["3john","3jn","3j"],chapters:1},{fullName:"Jude",abbreviations:["jude","jud","jd"],chapters:1},{fullName:"Revelation",abbreviations:["rev","re","rv"],chapters:22}];for(let e of r){let s=e.fullName.toLowerCase().replace(/\s+/g,"");this.bookNames.set(s,e.fullName),this.bookData.set(e.fullName,e);for(let t of e.abbreviations){let n=t.toLowerCase().replace(/\s+/g,"");this.bookAbbreviations.set(n,e.fullName)}}}};var E=class{formatVerseForObsidian(r,e){let s=r.reference,t=r.translation,n=r.text,a=e.verseCollapse?"> [!quote]- \u{1F4D6}":"> [!quote] \u{1F4D6}";return e.showReference&&(a+=` ${s}`),e.showTranslationName&&(e.showReference?a+=` (${t})`:a+=` ${t}`),n.split(`
`).forEach(i=>{a+=`
> ${i}`}),a+`

`}formatVerseForMarkdown(r,e){let s=r.reference,t=r.translation,n=r.text,a="> \u{1F4D6}";return e.showReference&&(a+=` **${s}**`),e.showTranslationName&&(e.showReference?a+=` (${t})`:a+=` **${t}**`),a+=`
>`,n.split(`
`).forEach(i=>{a+=`
> ${i}`}),a+`

`}formatVerseForPlainText(r,e){let s=r.reference,t=r.translation,n=r.text,a="";return e.showReference&&(a+=`${s}`),e.showTranslationName&&(e.showReference?a+=` (${t})`:a+=`${t}`),a?a+=`

${n}`:a=n,a+`

`}cleanVerseText(r,e){let s=/\[\d+\]/.test(r),t=r.trim();return e!=="ESV"&&(t=t.replace(/\[\d+\]/g,"")),t=t.replace(/\(\s*ESV\s*\)$/g,"").replace(/Â¶/g,"").replace(/\n\s*\n\s*\n/g,`
`).replace(/\s+/g," ").trim(),t}formatReference(r,e,s){if(s.length===0)return`${r} ${e}`;if(typeof s[0]=="number"){let t=s;return t.length===1?`${r} ${e}:${t[0]}`:t.length===2?`${r} ${e}:${t[0]}-${t[1]}`:`${r} ${e}:${t[0]}-${t[t.length-1]}`}else{let t=s;if(t.length===1){let n=t[0];return n.start===n.end?`${r} ${e}:${n.start}`:`${r} ${e}:${n.start}-${n.end}`}else{let n=t.map(a=>a.start===a.end?`${a.start}`:`${a.start}-${a.end}`);return`${r} ${e}:${n.join(",")}`}}}};var d=require("obsidian"),S=class extends d.Modal{constructor(e){super(e.app);this.isLoading=!1;this.plugin=e}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:"Insert Bible Verse"});let s=e.createDiv("reference-input-container");s.createEl("h3",{text:"Enter Bible Reference"}),this.referenceInput=s.createEl("input",{type:"text",placeholder:"e.g., John 3:16, Romans 8:28-39, Genesis 1:1-2:3"});let t=e.createDiv("translation-container");t.createEl("h3",{text:"Select Translation"}),this.translationSelect=t.createEl("select"),this.translationSelect.createEl("option",{value:"ESV",text:"English Standard Version (ESV)"}),this.translationSelect.createEl("option",{value:"NET",text:"New English Translation (NET)"}),this.translationSelect.value=this.plugin.settings.defaultTranslation;let n=e.createDiv("button-container");this.fetchButton=n.createEl("button",{text:"Fetch Verse",cls:"mod-cta"}),this.referenceInput.addEventListener("keypress",a=>{a.key==="Enter"&&this.fetchAndInsertVerse()}),this.fetchButton.addEventListener("click",()=>{this.fetchAndInsertVerse()}),this.referenceInput.focus(),this.addModalStyles()}onClose(){let{contentEl:e}=this;e.empty()}async fetchAndInsertVerse(){let e=this.referenceInput.value.trim(),s=this.translationSelect.value;if(!e){new d.Notice("Please enter a Bible reference");return}if(!this.isLoading){this.isLoading=!0,this.fetchButton.textContent="Fetching...",this.fetchButton.disabled=!0;try{let t=await this.plugin.fetchVerse(e,s);this.insertVerse(t),this.close()}catch(t){new d.Notice(`Error: ${t instanceof Error?t.message:String(t)}`)}finally{this.isLoading=!1,this.fetchButton.textContent="Fetch Verse",this.fetchButton.disabled=!1}}}insertVerse(e){this.plugin.insertVerse(e)}addModalStyles(){let e=document.createElement("style");e.textContent=`
			.reference-input-container, .translation-container, .button-container {
				margin-bottom: 20px;
			}
			
			.reference-input-container input, .translation-container select {
				width: 100%;
				padding: 4px 6px;
				border: 1px solid var(--background-modifier-border);
				border-radius: 4px;
				background-color: var(--background-primary);
				color: var(--text-normal);
				font-size: 14px;
			}
			
			.reference-input-container input:focus, .translation-container select:focus {
				outline: none;
				border-color: var(--interactive-accent);
			}
			
			.button-container {
				text-align: center;
			}
			
			.button-container button {
				padding: 10px 20px;
				background-color: var(--interactive-accent);
				color: var(--text-on-accent);
				border: none;
				border-radius: 4px;
				cursor: pointer;
				font-size: 14px;
				font-weight: 500;
				transition: background-color 0.2s;
			}
			
			.button-container button:hover {
				background-color: var(--interactive-accent-hover);
			}
			
			.button-container button:disabled {
				background-color: var(--background-modifier-border);
				color: var(--text-muted);
				cursor: not-allowed;
			}
			
			h3 {
				margin-bottom: 10px;
				color: var(--text-normal);
				font-size: 16px;
				font-weight: 500;
			}
			
			h2 {
				margin-bottom: 20px;
				color: var(--text-normal);
				font-size: 20px;
				font-weight: 600;
				text-align: center;
			}
		`,document.head.appendChild(e)}};var F={defaultTranslation:"NET",esvApiKey:"",showTranslationName:!0,showReference:!0,verseCollapse:!1},V=class extends l.Plugin{async onload(){await this.loadSettings(),this.referenceParser=new w,this.verseFormatter=new E,this.settings.esvApiKey&&(this.esvAPIService=new f(this.settings.esvApiKey)),this.netAPIService=new N,this.addCommand({id:"insert-bible-verse",name:"Insert Bible Verse",editorCallback:(r,e)=>{new S(this).open()}}),this.addSettingTab(new y(this.app,this))}onunload(){}async loadSettings(){this.settings=Object.assign({},F,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.settings.esvApiKey&&(this.esvAPIService=new f(this.settings.esvApiKey))}async fetchVerse(r,e){try{let s=this.referenceParser.parse(r),t=this.referenceParser.validateReference(s);if(!t.valid)throw new Error(`Invalid reference: ${t.errors.join(", ")}`);if(e==="ESV"){if(!this.esvAPIService)throw new Error("ESV API key is required. Please add it in settings.");return await this.esvAPIService.fetchVerse(r)}else{if(e==="NET")return await this.netAPIService.fetchVerse(r);throw new Error(`Unsupported translation: ${e}`)}}catch(s){throw new Error(`Failed to fetch verse: ${s instanceof Error?s.message:String(s)}`)}}insertVerse(r){let e=this.app.workspace.getActiveViewOfType(l.MarkdownView);if(e){let s=e.editor,t=s.getCursor(),n=this.verseFormatter.formatVerseForObsidian(r,this.settings);s.replaceRange(n,t),new l.Notice(`Inserted: ${r.reference}`)}else new l.Notice("No active markdown editor found")}},y=class extends l.PluginSettingTab{constructor(r,e){super(r,e),this.plugin=e}display(){let{containerEl:r}=this;r.empty(),r.createEl("h2",{text:"The Scripture Injector Settings"}),new l.Setting(r).setName("Default Translation").setDesc("Select your preferred Bible translation").addDropdown(e=>e.addOption("ESV","English Standard Version").addOption("NET","New English Translation").setValue(this.plugin.settings.defaultTranslation).onChange(async s=>{this.plugin.settings.defaultTranslation=s,await this.plugin.saveSettings()})),new l.Setting(r).setName("ESV API Key").setDesc("API key for ESV Bible API (required for ESV translation)").addText(e=>e.setPlaceholder("Enter your ESV API key").setValue(this.plugin.settings.esvApiKey).onChange(async s=>{this.plugin.settings.esvApiKey=s,await this.plugin.saveSettings()})),new l.Setting(r).setName("Show Translation Name").setDesc("Include translation name in formatted verses").addToggle(e=>e.setValue(this.plugin.settings.showTranslationName).onChange(async s=>{this.plugin.settings.showTranslationName=s,await this.plugin.saveSettings()})),new l.Setting(r).setName("Show Reference").setDesc("Include Bible reference in formatted verses").addToggle(e=>e.setValue(this.plugin.settings.showReference).onChange(async s=>{this.plugin.settings.showReference=s,await this.plugin.saveSettings()})),new l.Setting(r).setName("Verse Collapse").setDesc("Display verses in collapsible format").addToggle(e=>e.setValue(this.plugin.settings.verseCollapse).onChange(async s=>{this.plugin.settings.verseCollapse=s,await this.plugin.saveSettings()}))}};
